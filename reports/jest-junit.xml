<?xml version="1.0" encoding="UTF-8"?>
<testsuites name="jest tests" tests="33" failures="0" errors="0" time="0.657">
  <testsuite name="ImpersonationService" errors="0" failures="0" skipped="0" timestamp="2026-01-20T16:47:12" time="0.462" tests="22">
    <testcase classname="ImpersonationService should be defined" name="ImpersonationService should be defined" time="0.004">
    </testcase>
    <testcase classname="ImpersonationService startImpersonation should create impersonation session successfully" name="ImpersonationService startImpersonation should create impersonation session successfully" time="0.002">
    </testcase>
    <testcase classname="ImpersonationService startImpersonation should store target user email from DB in session" name="ImpersonationService startImpersonation should store target user email from DB in session" time="0.001">
    </testcase>
    <testcase classname="ImpersonationService startImpersonation should generate JWT with correct payload" name="ImpersonationService startImpersonation should generate JWT with correct payload" time="0">
    </testcase>
    <testcase classname="ImpersonationService startImpersonation should log impersonation start to audit" name="ImpersonationService startImpersonation should log impersonation start to audit" time="0.001">
    </testcase>
    <testcase classname="ImpersonationService startImpersonation should throw ConflictException if active session exists" name="ImpersonationService startImpersonation should throw ConflictException if active session exists" time="0.008">
    </testcase>
    <testcase classname="ImpersonationService startImpersonation should include approval ticket ID when provided" name="ImpersonationService startImpersonation should include approval ticket ID when provided" time="0.001">
    </testcase>
    <testcase classname="ImpersonationService endImpersonation should end active session successfully" name="ImpersonationService endImpersonation should end active session successfully" time="0.001">
    </testcase>
    <testcase classname="ImpersonationService endImpersonation should throw NotFoundException for non-existent session" name="ImpersonationService endImpersonation should throw NotFoundException for non-existent session" time="0">
    </testcase>
    <testcase classname="ImpersonationService endImpersonation should throw ConflictException if session already ended" name="ImpersonationService endImpersonation should throw ConflictException if session already ended" time="0">
    </testcase>
    <testcase classname="ImpersonationService endImpersonation should throw UnauthorizedException if not session owner" name="ImpersonationService endImpersonation should throw UnauthorizedException if not session owner" time="0.001">
    </testcase>
    <testcase classname="ImpersonationService endImpersonation should log impersonation end to audit" name="ImpersonationService endImpersonation should log impersonation end to audit" time="0">
    </testcase>
    <testcase classname="ImpersonationService endImpersonation should use default end reason if not provided" name="ImpersonationService endImpersonation should use default end reason if not provided" time="0.001">
    </testcase>
    <testcase classname="ImpersonationService getActiveSessions should return active sessions for platform user" name="ImpersonationService getActiveSessions should return active sessions for platform user" time="0">
    </testcase>
    <testcase classname="ImpersonationService getActiveSessions should return empty array when no active sessions" name="ImpersonationService getActiveSessions should return empty array when no active sessions" time="0.001">
    </testcase>
    <testcase classname="ImpersonationService getHistory should return session history with default limit" name="ImpersonationService getHistory should return session history with default limit" time="0">
    </testcase>
    <testcase classname="ImpersonationService getHistory should respect custom limit" name="ImpersonationService getHistory should respect custom limit" time="0.001">
    </testcase>
    <testcase classname="ImpersonationService logAction should add action to session log" name="ImpersonationService logAction should add action to session log" time="0">
    </testcase>
    <testcase classname="ImpersonationService logAction should silently return if session not found" name="ImpersonationService logAction should silently return if session not found" time="0.001">
    </testcase>
    <testcase classname="ImpersonationService cleanupExpiredSessions should end sessions older than 4 hours" name="ImpersonationService cleanupExpiredSessions should end sessions older than 4 hours" time="0">
    </testcase>
    <testcase classname="ImpersonationService cleanupExpiredSessions should not end sessions within 4 hours" name="ImpersonationService cleanupExpiredSessions should not end sessions within 4 hours" time="0.001">
    </testcase>
    <testcase classname="ImpersonationService cleanupExpiredSessions should handle no expired sessions" name="ImpersonationService cleanupExpiredSessions should handle no expired sessions" time="0">
    </testcase>
  </testsuite>
  <testsuite name="CsrfMiddleware" errors="0" failures="0" skipped="0" timestamp="2026-01-20T16:47:12" time="0.071" tests="11">
    <testcase classname="CsrfMiddleware should be defined" name="CsrfMiddleware should be defined" time="0.001">
    </testcase>
    <testcase classname="CsrfMiddleware use should skip when CSRF is disabled" name="CsrfMiddleware use should skip when CSRF is disabled" time="0.001">
    </testcase>
    <testcase classname="CsrfMiddleware use should skip excluded paths (webhooks)" name="CsrfMiddleware use should skip excluded paths (webhooks)" time="0">
    </testcase>
    <testcase classname="CsrfMiddleware use should skip health endpoint" name="CsrfMiddleware use should skip health endpoint" time="0">
    </testcase>
    <testcase classname="CsrfMiddleware use should skip API requests with Bearer token" name="CsrfMiddleware use should skip API requests with Bearer token" time="0.001">
    </testcase>
    <testcase classname="CsrfMiddleware use should skip API requests with API key" name="CsrfMiddleware use should skip API requests with API key" time="0">
    </testcase>
    <testcase classname="CsrfMiddleware use should skip API requests with client token" name="CsrfMiddleware use should skip API requests with client token" time="0">
    </testcase>
    <testcase classname="CsrfMiddleware use should generate token for GET requests" name="CsrfMiddleware use should generate token for GET requests" time="0.001">
    </testcase>
    <testcase classname="CsrfMiddleware use should apply CSRF protection for POST requests" name="CsrfMiddleware use should apply CSRF protection for POST requests" time="0">
    </testcase>
    <testcase classname="CsrfMiddleware use should throw ForbiddenException for invalid CSRF token" name="CsrfMiddleware use should throw ForbiddenException for invalid CSRF token" time="0.004">
    </testcase>
    <testcase classname="CsrfMiddleware use logs when CSRF token generation throws" name="CsrfMiddleware use logs when CSRF token generation throws" time="0">
    </testcase>
  </testsuite>
</testsuites>