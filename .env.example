# =============================================================================
# CHAPTERS STUDIO ERP - Environment Configuration
# =============================================================================
# ‚ö†Ô∏è SECURITY WARNING:
# - NEVER commit .env files with real credentials to version control
# - For production, use secrets management (Vault, K8s Secrets, AWS Secrets Manager)
# - The values below are for LOCAL DEVELOPMENT only
# - See docker-compose.yml for related infrastructure configuration
# =============================================================================

# üåç Application Environment
NODE_ENV=development
PORT=3000
APP_NAME="Chapters Studio ERP"
COMPANY_NAME="Chapters Studio"
COMPANY_URL="https://chapters-studio.com"

# üß≠ Reverse Proxy / Ingress
# Set to true when running behind a reverse proxy (e.g., Kubernetes ingress) so req.ip is correct.
TRUST_PROXY=false

# üóÑÔ∏è Database (PostgreSQL)
# ‚ö†Ô∏è PRODUCTION: Use secrets manager, not hardcoded values
DB_HOST=localhost
DB_PORT=5434
DB_USERNAME=chapters_studio
DB_PASSWORD=chapters_studio_secret
DB_DATABASE=chapters_studio
DB_SYNCHRONIZE=true   # ‚ö†Ô∏è Set to false in production - use migrations
DB_LOGGING=true

# üóÑÔ∏è Database Connection Pool (Tune for Production)
# DB_POOL_SIZE: Max connections (dev: 10-20, prod: 50-100 based on load)
DB_POOL_SIZE=20
# DB_CONNECTION_TIMEOUT: Connection acquisition timeout in ms (default: 30s)
DB_CONNECTION_TIMEOUT=30000
# DB_IDLE_TIMEOUT: Idle connection timeout in ms (default: 10min)
DB_IDLE_TIMEOUT=600000
# DB_STATEMENT_TIMEOUT: Max query execution time in ms (default: 60s)
DB_STATEMENT_TIMEOUT=60000

# üóÑÔ∏è Database Read Replicas (Optional - for high-availability)
# Comma-separated list of replica hosts (e.g., replica1.db.internal,replica2.db.internal)
# DB_REPLICA_HOSTS=
# DB_REPLICA_PORT=5432
# DB_REPLICA_USERNAME=
# DB_REPLICA_PASSWORD=

# üîê Authentication & Session Security
# ‚ö†Ô∏è JWT_SECRET must be at least 32 characters in production
JWT_SECRET=your-super-secret-jwt-key-change-in-production-min-32-chars
JWT_ACCESS_EXPIRES_SECONDS=900
JWT_REFRESH_EXPIRES_DAYS=7

# üõ°Ô∏è Security Hardening - Account Lockout
# Brute-force protection limits
LOCKOUT_MAX_ATTEMPTS=5
LOCKOUT_DURATION_SECONDS=1800
LOCKOUT_WINDOW_SECONDS=900

# üõ°Ô∏è Security Hardening - MFA Enforcement
# Comma-separated roles that require MFA (e.g., ADMIN,OPS_MANAGER)
MFA_REQUIRED_ROLES=ADMIN

# üõ°Ô∏è Security Hardening - CORS
# Comma-separated allowed origins (enforced strictly in production)
CORS_ORIGINS=http://localhost:3000,http://localhost:5173

# üì¶ Object Storage (MinIO / S3)
MINIO_ENDPOINT=http://localhost:9000
MINIO_BUCKET=chapters-studio
MINIO_REGION=us-east-1
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin
MINIO_PUBLIC_URL=http://localhost:9000

# üìß Email Service (SMTP)
MAIL_HOST=smtp.example.com
MAIL_PORT=587
MAIL_USER=noreply@example.com
MAIL_PASSWORD=your-mail-password
MAIL_FROM="Chapters Studio <noreply@chapters-studio.com>"
MAIL_FROM_NAME="Chapters Studio"
MAIL_FROM_ADDRESS="noreply@chapters-studio.com"

# üìä Telemetry & Observability
OTEL_ENABLED=true
ZIPKIN_ENDPOINT=http://localhost:9411/api/v2/spans
SENTRY_DSN=

# Grafana Loki Log Aggregation (Optional)
# Set LOKI_HOST to enable log shipping to Grafana Loki
# LOKI_HOST=http://localhost:3100

# Prometheus metrics protection
# - In production, if METRICS_TOKEN is unset, the /api/v1/metrics endpoint returns 404.
# - If set, requests must send: Authorization: Bearer <METRICS_TOKEN>
METRICS_TOKEN=

# ‚ö° Performance & Caching
REDIS_URL=redis://localhost:6379

# üõ†Ô∏è Maintenance & Backups
UPLOAD_TO_MINIO=true

# üß™ Initial Seeding (Required for 'npm run seed')
SEED_ADMIN_PASSWORD=Admin123!
SEED_STAFF_PASSWORD=Staff123!
SEED_OPS_PASSWORD=Ops123!
SEED_TENANT_NAME="Default Organization"
SEED_TENANT_SLUG="default-org"
SEED_EMAIL_DOMAIN="chapters-studio.com"

# üìã Booking Configuration
MAX_TASKS_PER_BOOKING=500

# üîë HashiCorp Vault (Optional Secret Management)
VAULT_ENABLED=false
VAULT_ADDR=http://localhost:8200
VAULT_TOKEN=
VAULT_ROLE_ID=
VAULT_SECRET_ID=
VAULT_SECRET_PATH=secret/data/chapters-studio-erp

# üß™ Development & Testing Utilities
TEST_ERROR_KEY=some-random-key-for-errors
TEST_MOCK_PASSWORD="Test@Mock#Password!2024"
TEST_MOCK_PASSWORD_WRONG="Wrong@Mock#Password!2024"

# ‚ö†Ô∏è DISABLE_RATE_LIMITING=true # Use ONLY during heavy local testing/e2e

# üí≥ Stripe Billing (Optional - for subscription management)
STRIPE_SECRET_KEY=
STRIPE_WEBHOOK_SECRET=
STRIPE_PUBLISHABLE_KEY=
